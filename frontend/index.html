<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Webcam Caption - Real-time Scene Description</title>
    <meta name="description" content="AI-powered real-time webcam captioning using SmolVLM. Get live descriptions of what your camera sees.">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/css/style.css">
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé•</text></svg>">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h2>AI Caption Engine</h2>
            <p id="loadingText">Initializing camera...</p>
            <div class="loading-steps">
                <div class="step" id="step1">üì∑ Camera Access</div>
                <div class="step" id="step2">ü§ñ AI Model Ready</div>
                <div class="step" id="step3">‚ú® Ready to Caption</div>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1 class="logo">
                <span class="logo-icon">üé•</span>
                AI Vision Caption
            </h1>
            <div class="header-controls">
                <button id="settingsBtn" class="btn btn-secondary" title="Settings">
                    ‚öôÔ∏è
                </button>
                <button id="fullscreenBtn" class="btn btn-secondary" title="Fullscreen">
                    üîç
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Camera Section -->
            <section class="camera-section">
                <div class="camera-container">
                    <video 
                        id="webcamVideo" 
                        autoplay 
                        playsinline 
                        muted
                        class="webcam-video"
                    ></video>
                    
                    <!-- Video Overlay -->
                    <div class="video-overlay">
                        <div class="recording-indicator" id="recordingIndicator">
                            <span class="recording-dot"></span>
                            <span>LIVE</span>
                        </div>
                        
                        <div class="video-controls">
                            <button id="pauseBtn" class="control-btn" title="Pause/Resume">
                                <span id="pauseIcon">‚è∏Ô∏è</span>
                            </button>
                            <button id="captureBtn" class="control-btn" title="Capture Now">
                                üì∏
                            </button>
                        </div>
                    </div>
                    
                    <!-- Status Messages -->
                    <div id="cameraStatus" class="camera-status hidden">
                        <div class="status-content">
                            <div class="status-icon">üì∑</div>
                            <h3>Camera Access Required</h3>
                            <p>Please allow camera access to start captioning</p>
                            <button id="retryCamera" class="btn btn-primary">Enable Camera</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Caption Section -->
            <section class="caption-section">
                <div class="caption-container">
                    <div class="caption-header">
                        <h2>
                            <span class="caption-icon">ü§ñ</span>
                            Live Description
                        </h2>
                        <div class="caption-status">
                            <span id="captionStatus" class="status-badge">Ready</span>
                            <span id="updateTimer" class="update-timer">Next update in 2s</span>
                        </div>
                    </div>
                    
                    <div class="caption-content">
                        <div id="captionText" class="caption-text">
                            <div class="placeholder-text">
                                <span class="typing-indicator">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </span>
                                Analyzing scene...
                            </div>
                        </div>
                        
                        <div class="caption-history" id="captionHistory">
                            <h3>Recent Descriptions</h3>
                            <div class="history-list" id="historyList">
                                <!-- History items will be added here -->
                            </div>
                            <button id="clearHistory" class="btn btn-ghost">Clear History</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Stats Section -->
            <section class="stats-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalCaptions">0</div>
                        <div class="stat-label">Captions Generated</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="avgResponseTime">0ms</div>
                        <div class="stat-label">Avg Response Time</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="uptime">00:00</div>
                        <div class="stat-label">Session Time</div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Settings</h3>
                <button id="closeSettings" class="modal-close">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label for="updateInterval">Update Interval</label>
                    <select id="updateInterval">
                        <option value="1000">1 second</option>
                        <option value="2000" selected>2 seconds</option>
                        <option value="3000">3 seconds</option>
                        <option value="5000">5 seconds</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label for="imageQuality">Image Quality</label>
                    <select id="imageQuality">
                        <option value="0.6">Low (Faster)</option>
                        <option value="0.8" selected>Medium</option>
                        <option value="1.0">High (Slower)</option>
                    </select>
                </div>
                
                <div class="setting-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="autoScroll" checked>
                        Auto-scroll to new captions
                    </label>
                </div>
                
                <div class="setting-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="soundEffects" checked>
                        Sound effects
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Toast -->
    <div id="errorToast" class="toast error-toast hidden">
        <div class="toast-content">
            <span class="toast-icon">‚ö†Ô∏è</span>
            <span id="errorMessage">An error occurred</span>
            <button id="closeError" class="toast-close">‚úï</button>
        </div>
    </div>

    <!-- Success Toast -->
    <div id="successToast" class="toast success-toast hidden">
        <div class="toast-content">
            <span class="toast-icon">‚úÖ</span>
            <span id="successMessage">Success!</span>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>
                Powered by <strong>SmolVLM</strong> ‚Ä¢ 
                Built with <strong>FastAPI</strong> ‚Ä¢ 
                <a href="/docs" target="_blank">API Docs</a>
            </p>
            <p class="footer-note">
                Your camera feed is processed locally and not stored or transmitted beyond this session.
            </p>
        </div>
    </footer>

    <!-- Hidden Canvas for Frame Capture -->
    <canvas id="captureCanvas" style="display: none;"></canvas>

    <!-- JavaScript -->
    <script src="/js/app.js"></script>
</body>
</html>